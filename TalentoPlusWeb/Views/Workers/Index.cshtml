@model IEnumerable<Worker>

@{
    ViewData["Title"] = "Workers";
}

<h1>Workers</h1>

@if (TempData["SuccessMessage"] != null)
{
    <div class="alert alert-success alert-dismissible fade show" role="alert">
        @TempData["SuccessMessage"]
        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
    </div>
}

<div class="row mb-3">
    <div class="col-md-6">
        <form asp-action="Index" method="get" class="d-flex">
            <input type="text" name="searchString" value="@ViewBag.SearchString" class="form-control me-2" placeholder="Search by name or email..." />
            <button type="submit" class="btn btn-outline-primary">Search</button>
            @if (!string.IsNullOrEmpty(ViewBag.SearchString))
            {
                <a asp-action="Index" class="btn btn-outline-secondary ms-2">Clear</a>
            }
        </form>
    </div>
    <div class="col-md-6 text-end">
        <a asp-action="Create" class="btn btn-primary">Create New</a>
        <a asp-action="Import" class="btn btn-success">Import from Excel</a>
    </div>
</div>

<div class="table-responsive">
    <table class="table table-striped table-hover">
        <thead class="table-dark">
            <tr>
                <th class="d-none d-md-table-cell">@Html.DisplayNameFor(model => model.DocumentoIdentidad)</th>
                <th>@Html.DisplayNameFor(model => model.FullName)</th>
                <th>@Html.DisplayNameFor(model => model.Email)</th>
                <th class="d-none d-lg-table-cell">@Html.DisplayNameFor(model => model.PhoneNumber)</th>
                <th class="d-none d-xl-table-cell">@Html.DisplayNameFor(model => model.Address)</th>
                <th>@Html.DisplayNameFor(model => model.Position)</th>
                <th>@Html.DisplayNameFor(model => model.Department)</th>
                <th class="d-none d-lg-table-cell">@Html.DisplayNameFor(model => model.Wage)</th>
                <th>@Html.DisplayNameFor(model => model.Status)</th>
                <th class="d-none d-xl-table-cell">@Html.DisplayNameFor(model => model.EducationalLevel)</th>
                <th class="d-none d-xxl-table-cell">@Html.DisplayNameFor(model => model.ProfessionalProfile)</th>
                <th class="d-none d-xxl-table-cell">@Html.DisplayNameFor(model => model.RegisterDate)</th>
                <th class="text-end">Actions</th>
            </tr>
        </thead>
        <tbody>
    @foreach (var item in Model) {
            <tr>
                <td class="d-none d-md-table-cell">@Html.DisplayFor(modelItem => item.DocumentoIdentidad)</td>
                <td>@Html.DisplayFor(modelItem => item.FullName)</td>
                <td>@Html.DisplayFor(modelItem => item.Email)</td>
                <td class="d-none d-lg-table-cell">@Html.DisplayFor(modelItem => item.PhoneNumber)</td>
                <td class="d-none d-xl-table-cell">@Html.DisplayFor(modelItem => item.Address)</td>
                <td>@Html.DisplayFor(modelItem => item.Position)</td>
                <td>@Html.DisplayFor(modelItem => item.Department)</td>
                <td class="d-none d-lg-table-cell">@String.Format("{0:C}", item.Wage)</td>
                <td>@Html.DisplayFor(modelItem => item.Status)</td>
                <td class="d-none d-xl-table-cell">@Html.DisplayFor(modelItem => item.EducationalLevel)</td>
                <td class="d-none d-xxl-table-cell" style="max-width: 200px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="@item.ProfessionalProfile">
                    @Html.DisplayFor(modelItem => item.ProfessionalProfile)
                </td>
                <td class="d-none d-xxl-table-cell">@item.RegisterDate.ToString("yyyy-MM-dd")</td>
                <td class="text-end" style="white-space: nowrap;">
                    <a asp-action="DownloadCv" asp-route-id="@item.Id" class="btn btn-sm btn-secondary" title="Download CV"><i class="bi bi-file-earmark-pdf"></i> PDF</a>
                    <a asp-action="Edit" asp-route-id="@item.Id" class="btn btn-sm btn-warning" title="Edit"><i class="bi bi-pencil"></i> Edit</a>
                    <a asp-action="Details" asp-route-id="@item.Id" class="btn btn-sm btn-info" title="Details"><i class="bi bi-info-circle"></i> Details</a>
                    <a asp-action="Delete" asp-route-id="@item.Id" class="btn btn-sm btn-danger" title="Delete"><i class="bi bi-trash"></i> Delete</a>
                </td>
            </tr>
    }
        </tbody>
    </table>
</div>

@if (ViewBag.TotalPages > 1)
{
    <nav aria-label="Page navigation">
        <ul class="pagination justify-content-center">
            <li class="page-item @(ViewBag.CurrentPage == 1 ? "disabled" : "")">
                <a class="page-link" asp-action="Index" asp-route-pageNumber="@(ViewBag.CurrentPage - 1)" asp-route-searchString="@ViewBag.SearchString">Previous</a>
            </li>
            @for (int i = 1; i <= ViewBag.TotalPages; i++)
            {
                <li class="page-item @(ViewBag.CurrentPage == i ? "active" : "")">
                    <a class="page-link" asp-action="Index" asp-route-pageNumber="@i" asp-route-searchString="@ViewBag.SearchString">@i</a>
                </li>
            }
            <li class="page-item @(ViewBag.CurrentPage == ViewBag.TotalPages ? "disabled" : "")">
                <a class="page-link" asp-action="Index" asp-route-pageNumber="@(ViewBag.CurrentPage + 1)" asp-route-searchString="@ViewBag.SearchString">Next</a>
            </li>
        </ul>
    </nav>
}
